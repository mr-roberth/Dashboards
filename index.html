<!DOCTYPE html>
<html>
<head>
    <title>Prueba Conexión GAS</title>
</head>
<body>
    <h2>Prueba de Conexión Apps Script</h2>
    
    <input type="text" id="url" style="width: 500px;" 
           value="https://script.google.com/macros/s/AKfycbxXogeMr6tsb_8h9Ql6T69Wpf04IhKi_GL7gB54PVblGMxzPFpCUkSOfJlepOEKe-Nb/exec">
    
    <button onclick="probarConexion()">Probar Conexión</button>
    
    <div id="resultado" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>
    
    <script>
    async function probarConexion() {
        const url = document.getElementById('url').value;
        const resultado = document.getElementById('resultado');
        
        resultado.innerHTML = "Probando conexión...";
        resultado.style.background = "#fff3cd";
        
        try {
            // PRIMERO: Probar con GET
            const getResponse = await fetch(url);
            const getData = await getResponse.text();
            
            resultado.innerHTML = `
                <strong>✅ GET funciona:</strong><br>
                Status: ${getResponse.status}<br>
                Respuesta: ${getData.substring(0, 200)}...
            `;
            resultado.style.background = "#d1e7dd";
            
            // SEGUNDO: Probar con POST
            const postResponse = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({action: 'test', test: true})
            });
            
            const postData = await postResponse.text();
            
            resultado.innerHTML += `<br><br>
                <strong>✅ POST funciona:</strong><br>
                Status: ${postResponse.status}<br>
                Respuesta: ${postData.substring(0, 200)}...
            `;
            
        } catch(error) {
            resultado.innerHTML = `
                <strong>❌ ERROR:</strong> ${error.message}<br><br>
                <strong>Posibles causas:</strong><br>
                1. La aplicación web no está desplegada como "Cualquier persona"<br>
                2. La URL es incorrecta<br>
                3. Hay un error en el código GAS<br>
                4. Bloqueo de CORS (usa el navegador Chrome)
            `;
            resultado.style.background = "#f8d7da";
        }
    }
    
    // Probar automáticamente al cargar
    window.onload = probarConexion;
    </script>
</body>
</html>
